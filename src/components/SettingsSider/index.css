.layers-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.layer-row {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 10px;
    border-radius: 10px;
    cursor: pointer;
    -webkit-user-select: none;
    user-select: none;
}

.layer-row.active {
    outline: 1px solid var(--ant-colorPrimary, #1677ff);
    background: rgba(22, 119, 255, 0.1);
}

.layer-left {
    flex: 0 0 auto;
}

.layer-main {
    flex: 1 1 auto;
    min-width: 0;
}

.layer-name {
    font-weight: 600;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.layer-meta {
    font-size: 12px;
    opacity: 0.75;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.layer-right {
    flex: 0 0 auto;
}

/*
  Drawer appearance
  - Semi-transparent background so the model is still slightly visible
  - Backdrop blur for readability

  Note: on mobile, Ant Drawer has several internal wrappers; we keep them
  transparent so our blurred translucent surface is always visible.
*/
.settings-drawer,
.settings-sider-fixed {
    --settings-panel-bg: var(--glass-panel-bg);
    --settings-panel-header-bg: var(--glass-panel-header-bg);
    --settings-panel-blur: var(--glass-panel-blur);
}

/* Smoothly animate between desktop and mobile panel geometry. */
.settings-drawer {
    transition:
        top 200ms ease,
        right 200ms ease,
        left 200ms ease,
        width 200ms ease,
        height 200ms ease,
        border-radius 200ms ease,
        box-shadow 200ms ease;
}

/* Apply blur surface to:
   - Ant Drawer content (legacy mobile implementation)
   - Desktop fixed panel
   - Mobile Teleport bottom sheet panel */
.settings-drawer .ant-drawer-content,
.settings-drawer .ant-drawer-content-wrapper,
.settings-sider-fixed,
.settings-drawer.settings-sheet {
    background: var(--settings-panel-bg) !important;
    backdrop-filter: blur(var(--settings-panel-blur)) !important;
    -webkit-backdrop-filter: blur(var(--settings-panel-blur)) !important;
}

/* Ensure Ant internal wrappers don't paint opaque layers over our blur */
.settings-drawer .ant-drawer-wrapper-body,
.settings-drawer .ant-drawer-body {
    background: transparent;
}

/* Mobile Teleport mask (captures outside clicks). Keep it subtle so blur stays visible. */
.settings-sheet-mask {
    position: fixed;
    inset: 0;
    z-index: 999;
    background: rgba(0, 0, 0, 0);
    pointer-events: none;
}

/* Mobile Teleport bottom sheet panel layout */
.settings-drawer.settings-sheet {
    display: flex;
    flex-direction: column;
    -webkit-overflow-scrolling: touch;
}

/* Mobile sheet open/close motion */
.settings-sheet-slide-enter-active,
.settings-sheet-slide-leave-active {
    transition: transform 180ms ease, opacity 180ms ease;
    will-change: transform, opacity;
}

.settings-sheet-slide-enter-from,
.settings-sheet-slide-leave-to {
    transform: translateY(18px);
    opacity: 0;
}

.settings-sheet-slide-enter-to,
.settings-sheet-slide-leave-from {
    transform: translateY(0);
    opacity: 1;
}

/* Mobile mask fade */
.settings-mask-fade-enter-active,
.settings-mask-fade-leave-active {
    transition: opacity 160ms ease;
}

.settings-mask-fade-enter-from,
.settings-mask-fade-leave-to {
    opacity: 0;
}

.settings-mask-fade-enter-to,
.settings-mask-fade-leave-from {
    opacity: 1;
}

/* Desktop teleported panel layout */
.settings-sider-fixed {
    display: flex;
    flex-direction: column;
    /* match Ant Drawer look/feel */
    -webkit-overflow-scrolling: touch;
    border-radius: 14px !important;
}

/* Desktop slide motion (no mask, no body scroll lock, no layout shift) */
.settings-sider-slide-enter-active,
.settings-sider-slide-leave-active {
    transition: transform 180ms ease, opacity 180ms ease;
    will-change: transform, opacity;
}

.settings-sider-slide-enter-from,
.settings-sider-slide-leave-to {
    transform: translateX(100%);
    opacity: 0;
}

.settings-sider-slide-enter-to,
.settings-sider-slide-leave-from {
    transform: translateX(0);
    opacity: 1;
}

/* Header */
.settings-header {
    flex: 0 0 auto;
    position: sticky;
    top: 0;
    z-index: 2;
    background: var(--settings-panel-header-bg);
    border-bottom: 1px solid rgba(0, 0, 0, 0.08);
    /* Keep the header readable over the translucent content */
    backdrop-filter: blur(var(--settings-panel-blur));
    -webkit-backdrop-filter: blur(var(--settings-panel-blur));
}

:root[data-theme="dark"] .settings-header {
    border-bottom: 1px solid rgba(255, 255, 255, 0.12);
}

.settings-header-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 10px 12px;
    gap: 10px;
}

.settings-title {
    font-weight: 600;
    font-size: 14px;
}

/* Mobile grab handle (resize hotzone) */
.settings-grab {
    padding: 10px 0 6px;
    cursor: row-resize;
    display: flex;
    justify-content: center;
    touch-action: none;
}

.settings-grab-bar {
    width: 44px;
    height: 4px;
    border-radius: 999px;
    background: rgba(0, 0, 0, 0.18);
}

:root[data-theme="dark"] .settings-grab-bar {
    /* On dark theme the handle must be bright enough to be visible */
    background: rgba(255, 255, 255, 0.26);
}

/* Body scroll container */
.settings-body {
    flex: 1 1 auto;
    min-height: 0;
    /* 非常关键：否则 iOS/某些浏览器不滚 */
    overflow-y: auto;
    scrollbar-gutter: stable;
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: contain;
    /* 防止滚动穿透到页面 */
    touch-action: pan-y;
    /* 明确允许纵向滚动手势 */
}

.settings-reset {
    margin-top: 12px;
    padding: 0 8px 12px;
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.settings-gap-top-xs {
    margin-top: 6px;
}

.settings-gap-top-sm {
    margin-top: 8px;
}

.settings-gap-top-md {
    margin-top: 12px;
}

.settings-gap-bottom-sm {
    margin-bottom: 8px;
}

.settings-block {
    display: block;
}

.settings-center {
    display: flex;
    justify-content: center;
}

.settings-text-center {
    text-align: center;
}

.settings-flex-wrap {
    flex-wrap: wrap;
}

.settings-input-wide {
    width: 140px;
}

.settings-col-compact {
    width: 96px;
}

.settings-col-wide {
    width: 140px;
}

.settings-full-width {
    width: 100%;
}

.settings-divider {
    margin: 8px 0;
}

.settings-dropdown-caret {
    margin-left: 6px;
    opacity: 0.75;
}

.settings-tag-ellipsis {
    display: inline-block;
    max-width: 260px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    vertical-align: bottom;
}

.settings-tag-full {
    max-width: 100%;
}

.settings-text-secondary {
    display: block;
    margin-top: 6px;
}

.settings-text-secondary-tight {
    display: block;
    margin-top: 8px;
}

.settings-text-secondary-compact {
    margin-bottom: 2px;
}

.settings-clear-confirm .ant-modal-body {
    padding: 16px 20px;
}

.settings-clear-confirm .ant-modal-confirm-body {
    align-items: center;
}

.settings-clear-confirm .ant-modal-confirm-content {
    margin-top: 6px;
}

/* Settings panel scrollbars (soft, theme-aware) */
.settings-body {
    scrollbar-width: thin;
    scrollbar-color: rgba(120, 120, 120, 0.35) transparent;
}

.settings-body::-webkit-scrollbar {
    width: 8px;
}

.settings-body::-webkit-scrollbar-track {
    background: transparent;
}

.settings-body::-webkit-scrollbar-thumb {
    background-color: rgba(120, 120, 120, 0.35);
    border-radius: 999px;
    border: 2px solid transparent;
    background-clip: padding-box;
}


/* While resizing the bottom-sheet, suppress overscroll (Chrome/Android) */
html.resizing,
body.resizing {
    overscroll-behavior-y: none;
    touch-action: none;
}

/* Collapse touch friendliness */
.settings-collapse :deep(.ant-collapse-header) {
    padding: 12px 0 !important;
    font-size: 13px;
}

.settings-panel-header {
    display: inline-flex;
    align-items: center;
    gap: 8px;
}

.settings-panel-icon {
    font-size: 18px;
}

.settings-panel-header > span:last-child {
    font-size: 15px;
    font-weight: 600;
}

.settings-panel-dirty {
    width: 6px;
    height: 6px;
    border-radius: 999px;
    background: var(--ant-colorPrimary, #1677ff);
    box-shadow: 0 0 0 2px rgba(22, 119, 255, 0.15);
}

.settings-collapse :deep(.ant-collapse-content-box) {
    padding: 0 0 12px 0 !important;
}

/* Native color input (used in Atom Colors panel) */
.color-picker {
    width: 100%;
    height: 32px;
}

/* Make InputNumber steppers easier to tap on mobile */
@media (max-width: 768px) {
    .settings-drawer :deep(.ant-input-number-handler-wrap) {
        width: 32px;
    }

    .settings-drawer :deep(.ant-input-number-handler) {
        height: 50%;
    }

    .settings-drawer :deep(.ant-form-item-label > label) {
        font-size: 13px;
    }
}
